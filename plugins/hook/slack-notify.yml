# EZ 插件示例 - Slack 通知钩子
name: slack-notify
type: hook
desc: "发送 Slack 通知"
version: "1.0"

# 钩子脚本，可在 ez-hooks 中引用
# 使用: script: "@plugin:slack-notify"
script: |
  #!/usr/bin/env bash
  # 需要设置 SLACK_WEBHOOK_URL 环境变量
  if [[ -z "$SLACK_WEBHOOK_URL" ]]; then
    echo "SLACK_WEBHOOK_URL not set, skipping notification"
    exit 0
  fi

  MSG="${EZ_HOOK_MESSAGE:-Task $EZ_TASK_NAME completed}"
  curl -s -X POST "$SLACK_WEBHOOK_URL" \
    -H 'Content-type: application/json' \
    -d "{\"text\": \"$MSG\"}" >/dev/null
  echo "Slack notification sent"
