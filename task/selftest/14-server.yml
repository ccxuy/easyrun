# Server/Client 测试
version: '3'

tasks:
  all:
    desc: "运行所有 Server/Client 测试"
    cmds:
      - task: server-files
      - task: help-commands
      - cmd: echo "✓ 14-server 全部通过"

  server-files:
    desc: "检查服务器文件存在"
    cmds:
      - cmd: test -f ./server/main.py
      - cmd: test -f ./server/requirements.txt
      - cmd: test -f ./server/templates/index.html
      - cmd: test -f ./server/templates/nodes.html
      - cmd: test -f ./server/templates/tasks.html
      - cmd: test -f ./server/templates/jobs.html
      - cmd: test -f ./server/static/css/style.css
      - cmd: test -f ./client/agent.py
      - cmd: test -f ./Dockerfile.server
      - cmd: test -f ./docker-compose.yml
      - cmd: echo "✓ server files OK"

  help-commands:
    desc: "检查帮助包含 server/client 命令"
    cmds:
      - cmd: ./ez help | grep -q "server status"
      - cmd: ./ez help | grep -q "server docker"
      - cmd: ./ez help | grep -q "client start"
      - cmd: ./ez help | grep -q "分布式"
      - cmd: echo "✓ help commands OK"
